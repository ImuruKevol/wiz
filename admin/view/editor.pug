mixin content()
    div(style="display: none;")
        form#file-form
            input#file-upload.form-control(type='file' name='file[]' multiple)

    .bg-dark.text-center(ng-if="!loaded" style="width: 100%; height: 100%; position: fixed; top: 0; left: 0; z-index: 99999; padding-top: 40vh;")
        .spinner-grow.text-white(style="width: 60px; height: 60px;")
    
    .main-panel.container.p-0(style="height: calc(100% - 112px);")
        div(data-split-pane data-split-pane-properties="properties.root")
            div(data-split-pane-component data-width="360px")
                div(style="height: 100%;")
                    .card-body.p-3(style="height: 100%; overflow: auto;")
                        script(type="text/ng-template" id="tree.html").
                            <div class="filetree">
                                <div class="title d-flex {{data.item.name == item.name && data.item.path == item.path ? 'active' : '' }}" ng-click="event.loader(item)">
                                    <span>
                                        <i class="fas fa-layer-group mr-1" ng-if="item.type == 'folder' && item.root"></i>
                                        <i class="fas fa-folder mr-1" ng-if="item.type == 'folder' && !item.root"></i>
                                        <i class="far fa-file mr-1" ng-if="item.type == 'file'"></i>
                                        <span>{{item.display ? item.display : item.name}}</span>
                                    </span>
                                </div>
                                <div class="sub">
                                    <div ng-repeat="item in item.sub" ng-include="'tree.html'"></div>
                                </div>
                            </div>
                        
                        .tree-container
                            .root-tree(ng-repeat="item in data.tree" ng-include="'tree.html'")
        
            div(data-split-pane-divider data-width="1px")
            
            div(data-split-pane-component style="height: 100%; overflow: hidden;")
                .panel-header.p-1.pr-0.pl-2(ng-if="status.view != 'system'")
                    .d-flex 
                        input(ng-if="status.view == 'folder'" type="checkbox" ng-click="event.check_items(data.item)" ng-model="data.item.checked")
                        span.ml-2.if-desktop.text-muted {{data.item.path[0] == '.' ? data.item.path.substring(1) : data.item.path }}/{{data.item.name}}
                        span.mr-auto &nbsp;

                        button.btn.btn-sm.btn-light.pt-1.pb-1.cursor-pointer.mr-1(ng-click="event.modal_delete(data.item, true)" style="height: 20px;" ng-if="status.view == 'folder'")
                            i.fas.fa-trash
                            span.ml-1.if-desktop Delete

                        button.btn.btn-sm.btn-light.pt-1.pb-1.cursor-pointer.mr-1(ng-click="event.create(data.item, 'folder')" style="height: 20px;" ng-if="status.view == 'folder'")
                            i.fas.fa-folder-plus
                            span.ml-1.if-desktop New Folder

                        button.btn.btn-sm.btn-light.pt-1.pb-1.cursor-pointer.mr-1(ng-click="event.create(data.item, 'file')" style="height: 20px;" ng-if="status.view == 'folder'")
                            i.fas.fa-file
                            span.ml-1.if-desktop New File

                        button.btn.btn-sm.btn-light.pt-1.pb-1.cursor-pointer.mr-1(ng-click="event.upload()" style="height: 20px;" ng-if="status.view == 'folder'")
                            i.fas.fa-cloud-upload-alt
                            span.ml-1.if-desktop Upload

                        button.btn.btn-sm.btn-light.pt-1.pb-1.cursor-pointer.mr-1(ng-click="event.save()" style="height: 20px;" ng-if="status.view == 'monaco'")
                            i.fas.fa-save
                            span.ml-1.if-desktop Save

                        button.btn.btn-sm.btn-light.pt-1.pb-1.cursor-pointer(ng-click="event.parent()" style="height: 20px;" ng-if="status.view != 'folder'")
                            i.fas.fa-times

                .panel-editor(ng-if="status.view == 'folder'" style="height: 100%; overflow: auto;" ng-drop="status.drop")
                    div(style="margin: 0 -12px;" ng-if="status.upload")
                        .progress.progress-sm
                            .progress-bar.bg-orange(style="width: {{status.upload_process}}%;" role='progressbar' aria-valuenow='38' aria-valuemin='0' aria-valuemax='100')
                    table.table.table-hover.mb-6
                        tr(ng-if="!data.item.root" ng-click="event.parent()")
                            td.pt-0.pb-0.cursor-pointer(colspan=3)
                                span.mr-2
                                    svg.icon(xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round")
                                        path(stroke="none" d="M0 0h24v24H0z" fill="none")
                                        path(d="M18 18h-6a3 3 0 0 1 -3 -3v-10l-4 4m8 0l-4 -4")
                                span ...

                        tr.target-file(ng-repeat="item in data.item.sub" ng-click="event.check_item(item)")
                            td.w-1.cursor-pointer.pr-2(style="white-space: nowrap;")
                                input.mr-2(type="checkbox" ng-model="item.checked")
                                i.fas.fa-folder(ng-if="item.type == 'folder'")
                                i.far.fa-file(ng-if="item.type != 'folder'")
                            td.pl-0.pr-0
                                span.title(ng-if="!item.edit" ng-click="event.loader(item)") {{item.name}}
                                input.form-control.form-control-sm.text-dark(ng-if="item.edit" ng-model="data.selected.rename" style="color: #000 !important; display: inline-block;" ng-enter="event.save_name()")

                            td.w-1.pl-0.text-right(style="white-space: nowrap;")
                                span.text-dark(ng-if="item.edit" style="font-size: 12px; width: 14px;" ng-click="event.save_name()")
                                    i.fas.fa-check-circle
                                span.text-dark(ng-if="!item.edit" style="font-size: 12px; width: 14px;" ng-click="event.change_name(item)")
                                    i.fas.fa-italic
                                span.text-dark.ml-1(ng-if="!item.edit" style="font-size: 12px; width: 14px;" ng-click="event.modal_delete(item)")
                                    i.fas.fa-trash

                .panel-editor(ng-if="status.view == 'image'" style="height: 100%; overflow: auto;")
                    img(src="{{data.item.url}}" style="width: 100%;")

                .panel-editor(ng-if="status.view == 'monaco' && status.editor" style="height: 100%; overflow: hidden;")
                    div(ng-model="data.item.text" ui-monaco-opts="monaco_properties" ui-monaco)

    #modal-delete-file.modal.fade(tabindex="-1")
        .modal-dialog.modal-sm(role='document')
            .modal-content
                .modal-body
                    .modal-title Delete
                    div Once deleted, it cannot be restored. Are you sure you want to delete?
                .modal-footer
                    button.btn.btn-link.link-secondary.mr-auto(type='button' data-dismiss='modal') Cancel
                    button.btn.btn-danger(type='button' ng-click="event.delete()") Delete

include wiz/theme/layout
+layout
